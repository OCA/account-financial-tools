===================
Cost-Revenue Spread
===================

.. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Faccount--financial--tools-lightgray.png?logo=github
    :target: https://github.com/OCA/account-financial-tools/tree/11.0/account_spread_cost_revenue
    :alt: OCA/account-financial-tools
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/account-financial-tools-11-0/account-financial-tools-11-0-account_spread_cost_revenue
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
    :target: https://runbot.odoo-community.org/runbot/92/11.0
    :alt: Try me on Runbot

|badge1| |badge2| |badge3| |badge4| |badge5| 

Allows to spread costs or revenues over a customizable periods, to even out cost or invoice spikes.

**Table of contents**

.. contents::
   :local:

Configuration
=============

To be able to access the full spreading features, the user must belong to *Show Full Accounting Features* group.

On the form view of the company, in the *Account Spread* tab, you can configure
the journals in which the spread journal items will be generated by default:

* the *Default Spread Journal for Revenues*,
* the *Default Spread Journal for Expenses*.

In the same *Account Spread* tab, you can also configure the Spread Balance Sheet Accounts used by default:

* the *Default Spread Account for Revenues*,
* the *Default Spread Account for Expenses*.

Usage
=====

Under Invoicing -> Adviser -> Accounting Entries -> Spread Costs/Revenues, create a new spread board.

Complete the definition of the spreading criteria, by setting the the fields:

* *Debit Account*
* *Credit Account*
* *Estimated Amount* (The total amount to spread)
* *Number of Repetitions*
* *Period Type* (Duration of each period)
* *Start date*
* *Journal*

.. figure:: static/description/spread.png
   :alt: Create a new spread board

Click on the button on the top-left to calculate the spread lines.

.. figure:: static/description/create_spread.png
   :alt: The spreading board is defined

A cron job will automatically create the accounting moves for all the lines having date previous that the current day (today).

.. figure:: static/description/update_spread.png
   :alt: The spreading board is updated by the cron job

By default, the status of the created accounting moves is unposted, so you should post them manually one by one.
To allow the automatic posting of the accounting moves, set the flag *Auto-post lines* to True.

Create an invoice or vendor bill in draft. On its lines, the spreading right-arrow icon are displayed in dark-grey color.

.. figure:: static/description/invoice_line_1.png
   :alt: On the invoice line the spreading icon is displayed

Click on the spreading right-arrow icon. A wizard prompts to enter a *Spread Action Type*:

- *Link to existing spread board*
- *Create from spread template*
- *Create new spread board*

Select *Link to existing spread board* and enter the previously generated Spread Board. Click on Confirm button:
the selected Spread Board will be automatically displayed.

Go back to the draft invoice/bill. The spreading functionality is now enabled on the invoice line:
the spreading right-arrow icon is now displayed in green color.

.. figure:: static/description/invoice_line_2.png
   :alt: On the invoice line the spreading icon is displayed in green color

Validate the invoice/bill. Click on the spreading (green) right-arrow icon to open the spread board, then click
on the smart button *Reconciled entries*: the moves of the spread lines are reconciled with the move of the invoice line.

In case the Subtotal Price of the invoice line is different than the *Estimated Amount* of the spread board, the spread
lines (not yet posted) will be recalculated when validating the invoice/bill.

Click on button *Recalculate entire spread* button in the spread board to force the recalculation of the spread lines:
this will also reset all the journal entries previously created.

Known issues / Roadmap
======================

* Verify last day of month
* Not yet compatible with cutoff module: create module for adaptation?

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/account-financial-tools/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us smashing it by providing a detailed and welcomed
`feedback <https://github.com/OCA/account-financial-tools/issues/new?body=module:%20account_spread_cost_revenue%0Aversion:%2011.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* Onestein

Contributors
~~~~~~~~~~~~

* Andrea Stirpe <a.stirpe@onestein.nl>

Other credits
~~~~~~~~~~~~~

Part of the code in this module (in particular the computation of the spread lines)
is highly inspired by the Assets Management module from the standard
Odoo 11.0 Community developed by Odoo SA.

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

.. |maintainer-astirpe| image:: https://github.com/astirpe.png?size=40px
    :target: https://github.com/astirpe
    :alt: astirpe

Current `maintainer <https://odoo-community.org/page/maintainer-role>`__:

|maintainer-astirpe| 

This module is part of the `OCA/account-financial-tools <https://github.com/OCA/account-financial-tools/tree/11.0/account_spread_cost_revenue>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
